set(CMAKE_EXPORT_COMPILE_COMMANDS 1)
cmake_minimum_required(VERSION 3.1)
project(sliprock)
enable_language(C)
include(GNUInstallDirs)
include_directories(include)
set(THREADS_PREFER_PTHREAD_FLAG 1)
find_package(Threads)
set(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake/Modules")
if (UNIX)
   find_package(Sodium REQUIRED)
elseif(WINDOWS)
   add_definitions(-DUNICODE -D_UNICODE -static-libgcc -static-libstdc++)
endif()
find_package(GTest)
if (CMAKE_C_COMPILER_IS_GNUCC)
   set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} -O0")
   set(CMAKE_C_FLAGS_DEBUG "${CMAKE_C_FLAGS_DEBUG} -O0")
endif()
if (CMAKE_C_COMPILER_ID STREQUAL "Clang")
   add_definitions(-Weverything -Werror -Wno-padded -Wno-gnu-statement-expression)
elseif(CMAKE_C_COMPILER_ID STREQUAL "GNU")
   add_definitions(-Wall -Wextra -Werror -Wstrict-aliasing=5 -Wformat=2 -Wstrict-overflow=5)
endif()
add_subdirectory(src)
if (SLIPROCK_ENABLE_WIP)
   add_subdirectory(wip)
endif()
install(FILES include/sliprock.h DESTINATION "${CMAKE_INSTALL_INCLUDEDIR}")
